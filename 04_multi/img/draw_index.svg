<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="693px" preserveAspectRatio="none" style="width:673px;height:693px;" version="1.1" viewBox="0 0 673 693" width="673px" zoomAndPan="magnify"><defs><filter height="300%" id="f4z4rxtdit3v1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="199" x="238.25" y="22.3184">index.html描画までのシーケンス</text><rect fill="#FFFFFF" filter="url(#f4z4rxtdit3v1)" height="69" style="stroke: #000000; stroke-width: 2.0;" width="213" x="154.5" y="210"/><rect fill="#FFFFFF" filter="url(#f4z4rxtdit3v1)" height="217" style="stroke: #000000; stroke-width: 2.0;" width="649.5" x="13" y="347"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="40" x2="40" y1="112" y2="608"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="199.5" x2="199.5" y1="112" y2="608"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="333.5" x2="333.5" y1="112" y2="608"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="539.5" x2="539.5" y1="112" y2="608"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="633.5" x2="633.5" y1="112" y2="608"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="23" y="110.3184">User</text><ellipse cx="40.5" cy="41" fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M40.5,49 L40.5,76 M27.5,57 L53.5,57 M40.5,76 L27.5,91 M40.5,76 L53.5,91 " fill="none" filter="url(#f4z4rxtdit3v1)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="23" y="619.3184">User</text><ellipse cx="40.5" cy="631" fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M40.5,639 L40.5,666 M27.5,647 L53.5,647 M40.5,666 L27.5,681 M40.5,666 L53.5,681 " fill="none" filter="url(#f4z4rxtdit3v1)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="164.5" y="79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="171.5" y="98.3184">Browser</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="66" x="164.5" y="607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="52" x="171.5" y="626.3184">Browser</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="309.5" y="79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="316.5" y="98.3184">Web</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="309.5" y="607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="316.5" y="626.3184">Web</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="519.5" y="79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="526.5" y="98.3184">API</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="36" x="519.5" y="607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="22" x="526.5" y="626.3184">API</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="34" x="614.5" y="79"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="20" x="621.5" y="98.3184">DB</text><rect fill="#FEFECE" filter="url(#f4z4rxtdit3v1)" height="28" style="stroke: #A80036; stroke-width: 1.5;" width="34" x="614.5" y="607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="20" x="621.5" y="626.3184">DB</text><polygon fill="#A80036" points="187.5,137,197.5,141,187.5,145,191.5,141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="193.5" y1="141" y2="141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="47.5" y="137.4385">URLにアクセス</text><polygon fill="#A80036" points="321.5,164,331.5,168,321.5,172,325.5,168" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="327.5" y1="168" y2="168"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="206.5" y="164.4385">/index.htmlのGET</text><polygon fill="#A80036" points="210.5,191,200.5,195,210.5,199,206.5,195" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="204.5" x2="332.5" y1="195" y2="195"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="110" x="216.5" y="191.4385">/index.htmlの返却</text><path d="M154.5,210 L227.5,210 L227.5,215 L217.5,225 L154.5,225 L154.5,210 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="69" style="stroke: #000000; stroke-width: 2.0;" width="213" x="154.5" y="210"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="169.5" y="222.4385">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="87" x="242.5" y="221.6787">[for each images]</text><polygon fill="#A80036" points="321.5,240,331.5,244,321.5,248,325.5,244" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="327.5" y1="244" y2="244"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="92" x="206.5" y="240.4385">画像のリクエスト</text><polygon fill="#A80036" points="210.5,267,200.5,271,210.5,275,206.5,271" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="204.5" x2="332.5" y1="271" y2="271"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="65" x="216.5" y="267.4385">画像の返却</text><polygon fill="#A80036" points="51.5,301,41.5,305,51.5,309,47.5,305" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="198.5" y1="305" y2="305"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="57.5" y="301.4385">画面を描画完了</text><polygon fill="#A80036" points="187.5,328,197.5,332,187.5,336,191.5,332" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="40.5" x2="193.5" y1="332" y2="332"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="135" x="47.5" y="328.4385">お金描画ボタンをクリック</text><path d="M13,347 L123,347 L123,352 L113,362 L13,362 L13,347 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="217" style="stroke: #000000; stroke-width: 2.0;" width="649.5" x="13" y="347"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="65" x="28" y="359.4385">非同期処理</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="331.5" x2="321.5" y1="381" y2="377"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="331.5" x2="321.5" y1="381" y2="385"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="332.5" y1="381" y2="381"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="103" x="206.5" y="377.4385">/api/money GET</text><polygon fill="#A80036" points="51.5,404,41.5,408,51.5,412,47.5,408" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="198.5" y1="408" y2="408"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="77" x="57.5" y="404.4385">JS処理は完了</text><polygon fill="#A80036" points="527.5,444,537.5,448,527.5,452,531.5,448" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="333.5" x2="533.5" y1="448" y2="448"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="340.5" y="431.4385">リバースプロキシにより</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="182" x="340.5" y="444.4385">APIサーバへリクエストを振り分け</text><polygon fill="#A80036" points="621.5,471,631.5,475,621.5,479,625.5,475" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="539.5" x2="627.5" y1="475" y2="475"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="546.5" y="471.4385">money取得</text><polygon fill="#A80036" points="550.5,498,540.5,502,550.5,506,546.5,502" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="544.5" x2="632.5" y1="502" y2="502"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="70" x="556.5" y="498.4385">レコード返却</text><polygon fill="#A80036" points="344.5,525,334.5,529,344.5,533,340.5,529" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="338.5" x2="538.5" y1="529" y2="529"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="350.5" y="525.4385">JSON返却</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="209.5" y1="556" y2="552"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="209.5" y1="556" y2="560"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="199.5" x2="332.5" y1="556" y2="556"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="59" x="216.5" y="552.4385">JSON返却</text><polygon fill="#A80036" points="51.5,586,41.5,590,51.5,594,47.5,590" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="45.5" x2="198.5" y1="590" y2="590"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="52" x="57.5" y="586.4385">画面更新</text><!--
@startuml draw_index

title index.html描画までのシーケンス

actor User as user
participant Browser as browser
participant Web as web
participant API as api
participant DB as db

user -> browser : URLにアクセス
browser -> web : /index.htmlのGET
web -> browser : /index.htmlの返却
loop for each images
    browser -> web : 画像のリクエスト
    web -> browser : 画像の返却
end
browser -> user : 画面を描画完了

user -> browser : お金描画ボタンをクリック
group 非同期処理
    browser ->> web : /api/money GET
    browser -> user : JS処理は完了
    web -> api : リバースプロキシにより\nAPIサーバへリクエストを振り分け
    api -> db : money取得
    db -> api : レコード返却
    api -> web : JSON返却
    web ->> browser : JSON返却
end
browser -> user : 画面更新

@enduml

PlantUML version 1.2019.06(Sat May 25 02:10:25 JST 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.3+7-Ubuntu-1ubuntu218.04.1
Operating System: Linux
OS Version: 4.15.0-20-generic
Default Encoding: UTF-8
Language: ja
Country: JP
--></g></svg>