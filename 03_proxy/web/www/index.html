<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>03_proxy</title>
    <script>
        const bodyId = "moneyTableBody";
        function clearBody() {
            let table = document.getElementById(bodyId);
            while (table.firstChild) {
                table.removeChild(table.firstChild);
            }
        }

        function appendMoney(money) {
            let body = document.getElementById(bodyId);
            for (let m of money) {
                let row = document.createElement("tr");

                let idTd = document.createElement("td");
                idTd.innerHTML = m.ID;
                row.appendChild(idTd);

                let dataTd = document.createElement("td");
                dataTd.innerHTML = m.Data;
                row.appendChild(dataTd);

                body.appendChild(row);
            }
        }

        async function fetchMoney() {
            const resp = await fetch("api/money");
            const data = await resp.json();
            clearBody();
            appendMoney(data);
        }

        async function insertMoney() {
            let money = document.getElementById("insertMoneyInput").value;
            await fetch("api/insert/" + money);
            await fetchMoney();
        }

        async function deleteMoney() {
            let id = document.getElementById("deleteIDInput").value;
            await fetch("api/delete/" + id);
            await fetchMoney();
        }
    </script>
</head>

<body>
    <div>
        <h1>お金管理</h1>
        <hr>

        <div>
            <h2>お金一覧取得</h2>
            <p>非同期でAPIを叩いてお金を画面に描画する</p>
            <input id="fetchButton" type="button" value="お金取得" onclick="fetchMoney();">
            <table>
                <thead>
                    <tr>
                        <td>ID</td>
                        <td>Data</td>
                    </tr>
                </thead>
                <tbody id="moneyTableBody">
                </tbody>
            </table>
        </div>

        <div>
            <h2>お金追加</h2>
            <p>お金を登録する</p>
            <input id="insertMoneyInput" type="text" value="">
            <input type="button" value="お金振込" onclick="insertMoney();">
        </div>

        <div>
            <h2>お金削除</h2>
            <p>お金を削除する</p>
            <input id="deleteIDInput" type="text" value="">
            <input type="button" value="お金削除" onclick="deleteMoney();" >
        </div>
    </div>

    <div>
        <h1>画像一覧</h1>
        <p>リバースプロキシの練習がしたかった。画像を表示することに意味はない。</p>
        <span> <img src="img/01.png" alt="image"> </span>
        <span> <img src="img/02.png" alt="image"> </span>
        <span> <img src="img/03.png" alt="image"> </span>
        <span> <img src="img/04.png" alt="image"> </span>
        <span> <img src="img/05.png" alt="image"> </span>
        <span> <img src="img/06.png" alt="image"> </span>
        <span> <img src="img/07.png" alt="image"> </span>
        <span> <img src="img/08.png" alt="image"> </span>
        <span> <img src="img/09.png" alt="image"> </span>
        <span> <img src="img/10.png" alt="image"> </span>
        <span> <img src="img/11.png" alt="image"> </span>
        <span> <img src="img/12.png" alt="image"> </span>
        <span> <img src="img/13.png" alt="image"> </span>
        <span> <img src="img/14.png" alt="image"> </span>
        <span> <img src="img/15.png" alt="image"> </span>
        <span> <img src="img/16.png" alt="image"> </span>
        <span> <img src="img/17.png" alt="image"> </span>
        <span> <img src="img/18.png" alt="image"> </span>
        <span> <img src="img/19.png" alt="image"> </span>
        <span> <img src="img/20.png" alt="image"> </span>
        <span> <img src="img/20.png" alt="image"> </span>
    </div>

</body>

</html>